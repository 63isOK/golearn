# 持续交付

- 发布可靠软件的系统方法
- 解决的问题：如何以最快的速度，将一个好的点子交付给用户
- 交付的过程：
  - 除了软件开发方法论
  - 还包括构建/部署/测试/发布的方法论，这部分是本书重点关注的
    - 就是软件经过设计/开发/测试后，如何将开发人员/测试人员/构建人员/运维人员协调一起高效工作
- 持续交付的核心模式是`部署流水线`
  - 本质上讲，就是构建/部署/测试到发布整个流程都是自动化实现
  - 过程上讲，就是输出文件，然后最对输入文件做一系列测试，证明其达到了发布质量要求
- 部署流水线的理论基石是ci，持续集成。部署流水线的目标是：
  - 让软件的构建/部署/测试/发布过程对所有人可见 - 促进合作
  - 快速反馈 - 更早的发现问题并解决
  - 提供一个完全自动化的过程，可在任意环境上部署和发布软件的任意版本 - 质量保证

## 发布反模式

特指一些和可靠的发布过程相对应的几种常见反模式：
- 手工部署发布
- 开发完成之后才向类生产环境部署
- 生产环境的手工配置管理

## 更好的选择

- 越容易出错的就应该越频繁的做，持续集成如此，持续部署也是如此
- 低风险/频繁/廉价/迅速/可预见 都是软件发布应该具有的特征
- 快速交付会赢得机会成本，交付质量会赢得客户的信赖
- 需要注意：质量不等于完美，追求完美的同义词是把事搞砸
  - 敏捷的tdd也提到了，保证满足需求的最小实现就是好的
  - 一个愿意花20元买牙刷的客户，准备一把普通牙刷就行，准备一个十万的水晶钻石牙刷就没必要
  - 一个愿意花十万买牙刷的客户，准备一把普通牙刷，就是质量不过关，因为普通牙刷并未达到需求中的发布质量要求
  - 所以我理解的质量是 满足需求的最小实现
- 频繁自动化发布软件可以很好地解决上面的反模式
  - 对于这种短周期，高质量的实践，反馈很重要，下面是反馈的三个标准
    - 任何变更都应该触发反馈流程
      - 可执行代码
      - 配置信息
      - 运行环境
      - 数据
    - 反馈应该尽快发出
    - 交付团队必须接收反馈，并依据反馈作出相应的行动
- 反馈至少包含以下几个检测：
  - 代码编译生成可执行的过程要通过，用于验证源码可用性
  - 单元测试必须通过，用于验证程序行为是否符合预期
  - 满足一定的质量标准，eg：测试覆盖率和其他技术相关的度量项
  - 功能验收必须通过，用于检查是否满足业务验收条件，是否达到期望的业务价值
  - 非功能验收必须通过，eg：性能/有效性/安全性等其他方面的要求
  - 探索性测试必须通过，可以做演示
  - 如果是跨平台软件，需要在不同操作系统不同版本上测试通过

## 持续交付的原则

- 为软件的发布创建一个可重复且可靠的过程
- 将几乎所有事情自动化
- 将所有东西都纳入版本控制
- 提前并频繁地做让你感到痛苦的事
- 内建质量
- done意味着已发布
- 交付过程是每个成员的责任
- 持续改进 戴明环 pdca

