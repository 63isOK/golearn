# 项目初始化

## 第一次提交

添加README.md 说明hugo是一个spf13钟爱的静态站点生成器,
特点是高效/灵活

## 第二次提交

对应的文档: docs下执行 hugo -p ~/code/src/github.com/spf13/hugo/docs -w -s -port 8000 [看代码之前先看](/hugo/source/doc-v001.md)

搭建了一个可运行的基本架子出来

- 添加license
- 添加基本运行的架子
- 添加附加说明文档

源码阅读:
- main.go 可执行:
    - 处理配置Config, 实际是用hugolib工具去实现,下面几个方法也是
    - 利用Config构造Site对象, 其中默认模板是post,索引默认支持分类和标签
    - 依次调用Site.Build 和 Site.Stats
- hugolib工具库:
    - config.go 读取配置文件,将配置存在一个Config结构体中
    - hugo会根据配置,创建一个站点, 用Site对象表示, 站点生成之后还可以进行运行
    - site.go 主要描述的是Site对象,这个对象包含了站点相关的所有元素
    - 分析Site.Build:
        - Site.Process
            - Site.initialize
                - 查看layout和source(就是指content)目录是否存在;查看publish目录是否创建
                - 遍历source下的文件, 把文件和目录都保存在Site的map中
                - 初始化Site里的部分元素
            - Site.prepTemplates
                - 创建一个新的template对象, 名字为"",这个对象用于处理html, 函数表中添加函数
                - 遍历layout下的文件, 对于每一个文件,依据文件名创建一个template对象,解析layout文件
                - 新建的模板对象都挂在名字为""的模板对象下,意味着: ""模板中可以引用layout下的所有模板
            - Site.CreatePages
                - 之前遍历source,数据放在Site.Files map中,遍历,为每个文件创建一个Page对象
                - Site.Pages 的类型是[]*Page, 具体的Page创建和排序,放在page.go中去分析
                - 在看下一个函数之前,需要先了解page.go中的创建/排序/获取参数
                - 这个函数会创建一个page对象,并添加到site对象中
            - Site.BuildSiteMeta
<<<<<<< HEAD
                - Site中存着两个map,一个是string-Pages,一个是string-Index,具体看代码可以分析
                - hugo中存在两类索引,一类分类,一类是自定义索引.分类可理解为按大类分,自定义索引就是标签
                - 分类可以是学习 生活 电影 美食,标签可以是编程 方法论 golang, 一个content可以是学习,也可以是 编程 golang
                - BuildSiteMeta第一件事就是将分类和标签理出来,整理出来的page,还按照发布日期排序
                - section作为渲染时的一个分类,默认取的是content type, 按section的不同,将page也做了分类和排序
                - 这个函数将 分类 标签 section 都做了整理和排序
=======
                - Site中存着两个map,一个是string-Pages,一个是string-Index
                - 更多的是将索引和分类排序了一下
>>>>>>> d68402295ee0811f8968f69d4a1780376ef2dd90
        - Site.Render
            - Site.RenderIndexes
                - 遍历所有的分类和标签,如果content对应着分类和标签,就创建一个html来管理
            - Site.RenderLists
                - list就是导航,按section分,如果有就创建一个导航页
            - Site.RenderPages
                - 渲染页面,对于每个content page,如果不指定模板,就使用/layout/content type/single.html模板
            - Site.ProcessShortcodes
                - 先找出shortcode的名称和参数,然后替换,将所有的全部替换完,shortcode不能嵌套
            - Site.RenderHomePage
        - Site.Write
            - Site.WritePages
                - 至此,静态站点的生成就ok了
    - 分析Site.Stats
    - page.go 分析
<<<<<<< HEAD
        - NewPage, 参数是一个content的路径,将文件头 front matter读出来,丢给page结构体,
            其中,md内容读出来分3块存储:原始md,解析之后的md,还有摘要md(就是md前多少字)
=======
        - NewPage 创建一个page对象
            - initializePage 用文件初始化一个page对象, 文件目录也有讲究,非content目录下的文件要特殊处理
            - buildPageFromFile 解析文件头,有两种文件头
                - json格式: 读取第一个{}, 读取头信息
                - md格式: 读取两个---之间的数据, 解析
                - 除了解析文件头,还做了两件事:设置输出文件名/将文件内容md,转换成page对象的内容
            - analyzePage 统计md中还多少字,几百字


>>>>>>> d68402295ee0811f8968f69d4a1780376ef2dd90


源码单步:
- 默认模板叫post


